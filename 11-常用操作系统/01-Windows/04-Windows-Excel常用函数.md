# Windows-Excel常用函数
日常工作中经常用到Excel，偶尔需要用到里面函数去处理表格，用的不多容易忘记，把用到的记录下来，避免下次忘了再到处查询。
### IF & OR & ISNUMBER & FIND函数
主要是IF函数，IF函数标准格式：
```
if(logical_test,[value_if_ture],[value_if_false])
```
例如在一个单元格，我输入对应的内容，指定的单元格就显示指定的内容，这就需要用到Exel的if函数。用个实例说明，可以一次性用到IF、OR、ISNUMBER和FIND这几个，如下图所示,要求：
- D列选择“地铁票、公交票、飞机票、火车票、住宿费、差旅补贴”，E列自动显示“差旅费”
- D列选择“办公及交通费”，E列显示“市内交通费”
- D列选择“误餐费”，E列显示“误餐费”
- D列选择“快递费”，E列显示“快递费”
- D列选择“通讯费”，E列显示“通讯费”
- D列选择“其它费用”，E列显示“其它费用”

![excel函数示例](excel函数示例.png)

##### D列设置list
首先设置可以选择值的list，步骤如下：
- 选中D2单元格，在主菜单栏点击“数据(data)”选项
- 在子工具分类栏中找到“数据工具(Data Toos)”
- 然后找到“数据验证(data validation)”，点击进入“数据验证”对话框
- 默认是“设置(settings)"选项，在"Allow"选项中选择list，并勾上后面两项，“数据”选项是默认的
- 在“源(Source)"中输入数据，地铁费及公交费这些，要用英文字符的逗号隔开
- 点击确认，可以看到D2单元格右边有选择项，任意选择即可，下拉应用到同列其它单元格即可

##### E列设置条件
在E列设置对应的条件，根据同行D列的值自动填入相应的值，就用到if函数，简略的来解释下用法：
```
=IF(OR(ISNUMBER(FIND({"长途车";"出租车"},D2))),"差旅费","其它费用")
```
说明如下：
- 第一层FIND就是在D2中查找大括号里面的值，长途车和出租车
- 第二次ISNUMBER就是个值得判断，判断是否是数字，返回的是false
- 然后是用OR，就是满足其中一个条件即可，OR和ISNUMBER都是给IF作bool判断用的
- 最后就是IF，前面都是bool值判断，"差旅费"是判断为True时输出的值，"其它费用"是判断false时输出的值

然后加入其它条件进行嵌套，那么E2中输入的完整内容如下（不要换行，这里是为了查看方便换行显示的，其它列同类单元格下拉即可）：
```
=IF(OR(ISNUMBER(FIND({"长途车";"出租车";"火车票";"住宿费";"飞机票";"地铁票";"公交票";"差旅补贴";"火车票"},D2))),"差旅费",
IF(OR(ISNUMBER(FIND("办公及交通费",D2))),"市内交通费",
IF(OR(ISNUMBER(FIND("误餐费",D2))),"误餐费",
IF(OR(ISNUMBER(FIND("通讯费",D2))),"通讯费",
IF(OR(ISNUMBER(FIND("快递费",D2))),"快递费","其它费用")))))
```
### SUMIF函数
上面的示例中还有一个统计表。E列中有差旅费、快递费和其它费用等，比较分散不是连在一起，并且有很多，F列是对应费用的金额，如何根据E列中的数据的类型，去对应统计F列中的数据和，需要用到SUMIF函数来解决。SUMIF函数的标准格式：
```
SUMIF(range,criteria,[sum_range])
```
示例图统计表中的差旅费后面的单元格输入的数据如下所示（其它列同类单元格下拉即可）：
```
=SUMIF(E2:E9, E11, F2:F9)
```
说明如下：
- E2:E9表示去判断的范围
- E11就是去匹配的值，E11是“差旅费”，也就是去E2:E9中匹配“差旅费”
- F2:F9就是值统计范围，统计的值是根据前面的判断来的

### VLOOKUP函数
VLOOKUP主要用途是进行数据匹配，举个简单例子，表格1中A对应的B，表格2中B对应的C，两个表格中很多个这种对应关系，并且序号都是杂乱无章，如何将A准确对应上C，用VLOOKUP就很方便。

VLOOKUP标准格式如下：
```
VLOOKUP(lookup_vaule,table_array,col_index_num,[range_lookup])
```
工作类型原因就用到过几次，现在差不多忘了，只知道有这么个用法，等以后用到了再写示例。

所以写文档好处就在这里，避免长期不用的知识忘了，再次使用的时候又要去查询，比较费时间，自己写的东西一看就懂了。
