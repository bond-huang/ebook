# Python-热点话题爬取
某些网站热点信息爬取，没什么实际意义，直接去网站查看也很直观，主要是学习。
### 某度搜索风云榜
##### 说明
爬取某度的搜索风云榜网站里面的实时热点,整理来说比较简单，主要问题说明：
- 关键字相对不好找，有的关键字还经常变，可能是网站反爬虫设计，例如搜索指数全面的关键字就发现了三种，并且很快进行变换，几分钟就变一次,写了几个if去判断，不知道会不会还会变，最后放弃了此关键字，三种如下：
    - `<span class="icon-rise">`
    - `<span class="icon-fill">`
    - `<span class="icon-fair">`
- 有的内容进行了多次匹配，达到了预期效果，没有多余的字符需要去优化
- 本身就是排行榜，所以不需要进行排序
- 爬取的是实时热点页面，把链接换成同一页面的今日热点或者七日热点都行
- 不知道内容解码的时候用utf-8不行，改成了gbk
##### 代码
完整代码如下：
```python
import re
from urllib import request
class PopularReptile():
    url = 'http://top.baidu.com/buzz?b=1&c=513&fr=topbuzz_b42_c513'
    root_pattern = '<td class="first">([\s\S]*?)</tr>'
    top_pattern1 = '<span class="num-top">(\d*)</span>'
    top_pattern2 = '<span class="num-normal">(\d*)</span>'
    name_pattern1 = '<td class="keyword">([\s\S]*?)</a>'
    name_pattern2 = '>([\s\S]*?)$'
    icon_pattern1 = '<td class="last">([\s\S]*?)</span>'
    icon_pattern2 = '>([\s\S]*?)$'
    def __fetch_content(self):
        web_content = request.urlopen(PopularReptile.url)
        web_content = web_content.read()
        web_content = str(web_content,encoding='gbk')
        return web_content
    def __analysis(self,web_content):
        root_popular = re.findall(PopularReptile.root_pattern,web_content)
        popular_list = []
        for populars in root_popular:
            top = re.findall(PopularReptile.top_pattern1,populars)
            if len(top) == 0:
                top = re.findall(PopularReptile.top_pattern2,populars)
            name1 = re.findall(PopularReptile.name_pattern1,populars)
            name2 = re.findall(PopularReptile.name_pattern2,name1[0])
            icon1 = re.findall(PopularReptile.icon_pattern1,populars)
            icon2 = re.findall(PopularReptile.icon_pattern2,icon1[0])
            popular = {'top':top,'name':name2,'icon':icon2}
            popular_list.append(popular)
        return popular_list
    def __show(self,popular_list):
        for popular_item in popular_list:
            print('搜索排行'+ popular_item['top'][0]+'：'\
                + popular_item['name'][0]+';'\
                    + '搜索指数:'+ popular_item['icon'][0]+'。')
    def entrance(self):
        web_content = self.__fetch_content()
        popular_list = self.__analysis(web_content)
        self.__show(popular_list)
popular_reptile = PopularReptile()
popular_reptile.entrance()
```
正则表达式写好爬取后，发现还比较整齐的，没有多余的字符，不需要进行优化，并且本身就是有排行，所以也不需要进行排序，示例如下：
```
['1']
['官方通报西安明秦王府城墙坍塌']
['4802320']
['2']
['河北女孩遭绑架杀害嫌疑人被抓']
['4634239']
['3']
['黎巴嫩总统称3周前就知道有危险']
['4472040']
```
放到字典后：
```
[{'top': ['1'], 'name': ['官方通报西安明秦王府城墙坍塌'], 'icon': ['4915359']}, {'top': ['2'], 'name': ['河北女孩遭绑架杀害嫌疑人被 
抓'], 'icon': ['4743321']}, {'top': ['3'], 'name': ['黎巴嫩总统称3周前就知道有危险'], 'icon': ['4577305']}, {'top': ['4'], 'name': ['陈思诚为佟丽娅庆生'], 'icon': ['4417099']}, {'top': ['5'], 'name': ['宋小女称不会要张玉环一分赔偿金'], 'icon': ['4262501']}, {'top': ['6'], 'name': ['香港特区政府回应美国制裁'], 'icon': ['4113313']}, {'top': ['7'], 'name': ['王珞丹凌晨发文又秒删'], 'icon': ['3969347']}, {'top': ['8'], 'name': ['印度客机滑出跑道断成两截'], 'icon': ['3830420']}, {'top': ['9'], 'name': ['北京奥运12年'], 'icon': 
['3696355']}, {'top': ['10'], 'name': ['广西女护士杀害男医生被提起公诉'], 'icon': ['3566983']}, {'top': ['11'], 'name': ['上海首例养
犬人遗弃犬只案'], 'icon': ['3442139']}, {'top': ['12'], 'name': ['蔡徐坤陈立农小船翻了'], 'icon': ['3321664']}, {'top': ['13'], 'name': ['骆惠宁回应美国财政部所谓制裁'], 'icon': ['3205405']}, {'top': ['14'], 'name': ['大妈闹市放羊啃食绿化带'], 'icon': ['3093216']}, {'top': ['15'], 'name': ['伊能静发小作文为张雨绮庆生'], 'icon': ['2984954']}, {'top': ['16'], 'name': ['比熊犬给黑豹幼崽当奶妈'], 
'icon': ['2880480']}, {'top': ['17'], 'name': ['邓超送白玉兰花安慰孙俪'], 'icon': ['2779663']}, {'top': ['18'], 'name': ['郑恺发文回
忆跑男100期'], 'icon': ['2682375']}, {'top': ['19'], 'name': ['喻言成功追星明道'], 'icon': ['2497895']}, {'top': ['20'], 'name': [' 
暴风集团冯鑫又被限制高消费'], 'icon': ['2410468']}, {'top': ['21'], 'name': ['腾讯回应特朗普禁令'], 'icon': ['2166124']}, {'top': ['22'], 'name': ['中国人均国民总收入首破1万美元'], 'icon': ['2090310']}, {'top': ['23'], 'name': ['山下智久与17岁高中生酒店约会'], 'icon': ['2017149']}, {'top': ['24'], 'name': ['英国外交部首席捕鼠官将退休'], 'icon': ['1946549']}, {'top': ['25'], 'name': ['加拿大将 
对美国铝产品征收反关税'], 'icon': ['1878420']}, {'top': ['26'], 'name': ['美国新冠肺炎确诊超491万例'], 'icon': ['1812675']}, {'top': ['27'], 'name': ['新疆新增本土病例25例'], 'icon': ['1749231']}]
```
最后输出结果如下：
```
PS C:\Users\QianHuang\Desktop\big1000\vscode\codefile\reptile> python module_5.py
搜索排行1：官方通报西安明秦王府城墙坍塌;搜索指数:4799605。
搜索排行2：黎巴嫩总统称3周前就知道有危险;搜索指数:4631619。
搜索排行3：陈思诚为佟丽娅庆生;搜索指数:4313079。
搜索排行4：宋小女称不会要张玉环一分赔偿金;搜索指数:4162122。
搜索排行5：香港特区政府回应美国制裁;搜索指数:4016447。
搜索排行6：王珞丹凌晨发文又秒删;搜索指数:3875872。
搜索排行7：印度客机滑出跑道断成两截;搜索指数:3740216。
搜索排行8：北京奥运12年;搜索指数:3609309。
搜索排行9：广西女护士杀害男医生被提起公诉;搜索指数:3482983。
搜索排行10：上海首例养犬人遗弃犬只案;搜索指数:3361078。
搜索排行11：蔡徐坤陈立农小船翻了;搜索指数:3243441。
搜索排行12：骆惠宁回应美国财政部所谓制裁;搜索指数:3129920。
搜索排行13：大妈闹市放羊啃食绿化带;搜索指数:3020373。
搜索排行14：伊能静发小作文为张雨绮庆生;搜索指数:2914660。
搜索排行15：河北女孩遭绑架杀害嫌疑人被抓;搜索指数:2812647。
搜索排行16：邓超送白玉兰花安慰孙俪;搜索指数:2714204。
搜索排行17：郑恺发文回忆跑男100期;搜索指数:2619207。
搜索排行18：CBA选秀球员名单;搜索指数:2527535。
搜索排行19：喻言成功追星明道;搜索指数:2439071。
搜索排行20：暴风集团冯鑫又被限制高消费;搜索指数:2353703。
搜索排行21：中国人均国民总收入首破1万美元;搜索指数:2271324。
搜索排行22：北京12批次食品不合格;搜索指数:2191827。
搜索排行23：腾讯回应特朗普禁令;搜索指数:2041084。
搜索排行24：山下智久与17岁高中生酒店约会;搜索指数:1969647。
搜索排行25：英国外交部首席捕鼠官将退休;搜索指数:1900709。
搜索排行26：加拿大将对美国铝产品征收反关税;搜索指数:1834184。
搜索排行27：美国新冠肺炎确诊超491万例;搜索指数:1769988。
搜索排行28：新疆新增本土病例25例;搜索指数:1708038。
```
把链接换成同一页面的今日热点或者七日热点都行，七日热点输出示例如下：
```
PS C:\Users\QianHuang\Desktop\big1000\vscode\codefile\reptile> python module_5.py
搜索排行1：特朗普宣布45天后禁止与微信交易;搜索指数:718781。
搜索排行2：南京失联女生被其男友杀害埋尸;搜索指数:598367。
搜索排行3：影院老板砸花木兰宣传板;搜索指数:581728。
搜索排行4：张一山宋妍霏分手;搜索指数:552616。
搜索排行5：全球面临50年来最严重粮食危机;搜索指数:510307。
搜索排行6：杭州杀妻分尸案嫌犯被批捕;搜索指数:505780。
搜索排行7：黎巴嫩奶奶在破损房间中弹钢琴;搜索指数:479461。
搜索排行8：曾志伟妻子去世;搜索指数:478499。
搜索排行9：黎巴嫩首都爆炸已致70余人死亡;搜索指数:470845。
搜索排行10：美国取消全球旅行警告;搜索指数:445052。
搜索排行11：钟南山成为共和国勋章建议人选;搜索指数:441717。
搜索排行12：多地确定新学期开学日期;搜索指数:432286。
搜索排行13：白雪否认与张一山复合;搜索指数:429816。
搜索排行14：峨眉山警方通报林间发现两具尸体;搜索指数:421966。
搜索排行15：华为天才少年最高年薪201万元;搜索指数:385178。
搜索排行16：华为年薪201万天才少年回应;搜索指数:383934。
搜索排行17：张嘉译改名张嘉益;搜索指数:360950。
搜索排行18：南京遇害女生男友曾一起去报案;搜索指数:359921。
搜索排行19：张玉环称曾遭6天6夜刑讯逼供;搜索指数:348074。
搜索排行20：宋妍霏分手当日片场状态;搜索指数:341688。
搜索排行21：张天爱喊话跟拍者;搜索指数:338625。
搜索排行22：清华大学生起诉ofo反赔400元;搜索指数:315678。
搜索排行23：浙大犯强奸罪学生被开除学籍;搜索指数:311691。
搜索排行24：张玉环与前妻再见面紧握双手;搜索指数:310370。
搜索排行25：法国女婿回应吐槽中国丈母娘;搜索指数:306198。
搜索排行26：妈妈倒车时不慎撞死自己孩子;搜索指数:299914。
搜索排行27：云南吃野生菌中毒死亡人数超新冠;搜索指数:299442。
搜索排行28：张萌就吐槽林有有角色一事道歉;搜索指数:291734。
搜索排行29：酒吧打出优衣库女主角驻唱广告;搜索指数:287165。
搜索排行30：世卫警告新冠可能永远没有特效药;搜索指数:284278。
搜索排行31：襄阳失踪女童被翻墙逃走邻居杀害;搜索指数:279134。
搜索排行32：官方通报干部疑出轨在妻死后失联;搜索指数:277286。
搜索排行33：宋小女想把儿孙留在张玉环身边;搜索指数:276077。
搜索排行34：男子拒戴口罩捶公交司机16拳获刑;搜索指数:274010。
搜索排行35：四大行回应薪酬问题;搜索指数:273454。
搜索排行36：韩国25岁女运动员自杀;搜索指数:272617。
搜索排行37：外交部回应澳总理称欢迎中国崛起;搜索指数:265715。
搜索排行38：为救弟弟落水失踪微信余额被提现;搜索指数:259926。
搜索排行39：罗志祥 谢谢大家;搜索指数:257149。
搜索排行40：杭州新增1例无症状感染者;搜索指数:256641。
搜索排行41：妻子雨中吃面丈夫身旁打伞;搜索指数:256263。
搜索排行42：女生被杀案嫌犯父亲是司法局干部;搜索指数:252683。
搜索排行43：月嫂拍打抛扔出生6天婴儿;搜索指数:251161。
搜索排行44：美国驱逐中国记者 胡锡进评论;搜索指数:249031。
搜索排行45：北京新增1例本土确诊病例;搜索指数:248463。
搜索排行46：新手消防员分管供水车开心到飞起;搜索指数:247034。
搜索排行47：外交部回应美卫生部长拟率团访台;搜索指数:244320。
搜索排行48：黎巴嫩爆炸造成30万人无家可归;搜索指数:242211。
搜索排行49：三十而已样片泄露 出品方报警;搜索指数:240808。
搜索排行50：宋小女称再婚前曾提三个条件;搜索指数:238937。
```
